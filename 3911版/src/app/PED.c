#include "global.h"
unsigned char Mkey_3Des[101][16]=
{
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01},
	{0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02},
	{0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03},
	{0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04},
	{0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05},
	{0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06},
	{0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07},
	{0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08},
	{0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09},
	{0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10},
	{0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11},
	{0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12},
	{0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13},
	{0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14},
	{0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15},
	{0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16},
	{0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17},
	{0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18},
	{0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19},
	{0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20},
	{0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21},
	{0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22},
	{0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23},
	{0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24},
	{0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25},
	{0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26},
	{0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27},
	{0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28},
	{0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29},
	{0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30},
	{0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31},
	{0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32},
	{0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33},
	{0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34},
	{0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35},
	{0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36},
	{0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37},
	{0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38},
	{0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39},
	{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40},
	{0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41},
	{0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42},
	{0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43},
	{0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44},
	{0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45},
	{0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46},
	{0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47},
	{0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48},
	{0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49},
	{0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50},
	{0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51},
	{0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52},
	{0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53},
	{0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54},
	{0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55},
	{0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56},
	{0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57},
	{0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58},
	{0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59},
	{0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60},
	{0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61},
	{0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62},
	{0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63},
	{0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64},
	{0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65},
	{0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66},
	{0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67},
	{0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68},
	{0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69},
	{0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70},
	{0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71},
	{0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72},
	{0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73},
	{0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74},
	{0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75},
	{0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76},
	{0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77},
	{0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78},
	{0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79},
	{0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80},
	{0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81},
	{0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82},
	{0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83},
	{0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84},
	{0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85},
	{0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86},
	{0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87},
	{0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88},
	{0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89},
	{0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90},
	{0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91},
	{0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92},
	{0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93},
	{0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94},
	{0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95},
	{0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96},
	{0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97},
	{0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98},
	{0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99}	
};
unsigned char Wkey_3Des[101][16]=
{
	{0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99,0x99},
	{0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98,0x98},
	{0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97,0x97},
	{0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96,0x96},
	{0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95,0x95},
	{0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94,0x94},
	{0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93,0x93},
	{0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0x92},
	{0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91,0x91},
	{0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90},
	{0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89,0x89},
	{0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88},
	{0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87},
	{0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86},
	{0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85,0x85},
	{0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84},
	{0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83},
	{0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0x82},
	{0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81},
	{0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80},
	{0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79,0x79},
	{0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78},
	{0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77},
	{0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76,0x76},
	{0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75,0x75},
	{0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74,0x74},
	{0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73,0x73},
	{0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72,0x72},
	{0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71},
	{0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70,0x70},
	{0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69,0x69},
	{0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68,0x68},
	{0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67,0x67},
	{0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66},
	{0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65,0x65},
	{0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64,0x64},
	{0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63},
	{0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62,0x62},
	{0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61,0x61},
	{0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60},
	{0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59,0x59},
	{0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58,0x58},
	{0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57,0x57},
	{0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56,0x56},
	{0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55},
	{0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54,0x54},
	{0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53},
	{0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52},
	{0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51,0x51},
	{0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50,0x50},
	{0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49,0x49},
	{0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48},
	{0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47,0x47},
	{0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46},
	{0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45,0x45},
	{0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44},
	{0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43,0x43},
	{0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42},
	{0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41,0x41},
	{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40},
	{0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39,0x39},
	{0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38,0x38},
	{0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37,0x37},
	{0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36,0x36},
	{0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35,0x35},
	{0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34,0x34},
	{0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33},
	{0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32,0x32},
	{0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31},
	{0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30},
	{0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29,0x29},
	{0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28},
	{0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27,0x27},
	{0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26,0x26},
	{0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25,0x25},
	{0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24},
	{0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23,0x23},
	{0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22},
	{0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21},
	{0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20},
	{0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19,0x19},
	{0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18},
	{0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17,0x17},
	{0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x16},
	{0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15,0x15},
	{0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14},
	{0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13},
	{0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12},
	{0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11},
	{0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10},
	{0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09},
	{0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08},
	{0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07},
	{0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06},
	{0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05},
	{0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04},
	{0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03},
	{0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02},
	{0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01},
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}
};
unsigned char CupMacOut[101][17]=
{
	"5AE71B3C83261C29",
	"6D851F6DF70640F4",
	"62AACE5A656C9BC4",
	"52D3F4009F890F3B",
	"AD5C3BC971494450",
	"7695DA593310A242",
	"57785171F6522135",
	"331AE443D3CB49A7",
	"82E6F3B1BD25F749",
	"92DEDB93825D6A7D",
	"AF98605EBFBD5AFC",
	"37A891F992BCF382",
	"F3A9E2BD9B955204",
	"7E551638FB0F2191",
	"8F5798847D511611",
	"4F96A42D748666F0",
	"2B6BCBF99E613D2A",
	"9B4470FDF8D25989",
	"6EB148A985551450",
	"FDE9AF654BBAD065",
	"82233BD77F69D0BF",
	"361C84A0F47198D5",
	"CF9F8F4E9819487A",
	"1BED53D8B76948D8",
	"B5E832B6317ECCAA",
	"5B4CA61A4219ACAB",
	"4B510D43DF023DBF",
	"FA8A38C0E482BF13",
	"3D7E7C025C3BB03A",
	"51510BE3C469F218",
	"01CE13F80E194C36",
	"7C974FE9860F4BF1",
	"BE9809F15A9670E8",
	"272BF70A0A072FF7",
	"7DFED8FC9CF63EE8",
	"A44A997B344159F1",
	"61756464878359AC",
	"B929DE65AD91E654",
	"A90E52B16C6BD8D8",
	"4E9ECB96EB7CE8A2",
	"8456E0F781E22A27",
	"C6270F5F4CCC47D6",
	"7492DD63123A68C8",
	"2438E733BB81FC4B",
	"83D5BB7EAECB18D4",
	"F3D21D87BD96341D",
	"560DF1D72A63A9C6",
	"2526804C52EE3984",
	"4A400A373A518F0F",
	"7E540FDE1EADA9A3",
	"3266ABDDC4C52A97",
	"C79F90F133198112",
	"6BE0941A0B1A2334",
	"DC110E0ADE61559E",
	"B535E91A557C9281",
	"A54DA6E50A571DBD",
	"1CF591B59E5510F9",
	"6458840E80727099",
	"2C481A209ED90EDF",
	"DB97DCF3941DD89D",
	"DAE7C69C8E25C22A",
	"A5A4D0B4DF6C52B0",
	"5940B5701C4D815F",
	"6BA21A2867D22735",
	"AE143CFC5525274D",
	"349D57B495AA9CCD",
	"B9461218074A8638",
	"5FA538DBCFF68C17",
	"B2FC5AFAEDB2655D",
	"F64A677F9FE8DE84",
	"98D805062FC12DAF",
	"4DD2899A63585862",
	"FD19EBED90C07075",
	"7FCA7736024060D6",
	"E8C3D6A3365808E1",
	"301C5F50128CC238",
	"4F87D69FC5676DC2",
	"B41606563CA8A670",
	"8C5C1729B1EA8B60",
	"B50E43AC07AB9288",
	"C87A8BE9842C63A7",
	"3E3B19FA83467F6F",
	"7ACEF07AF4084938",
	"DC87B501BCB181B5",
	"C7E8F7E6788256F7",
	"DC4BC6B4D010E4CC",
	"C816802A09F12C00",
	"F31754B13EFE2707",
	"88B4CCDCC307CBC3",
	"0371B26248950DB7",
	"1CC87CA29E92726A",
	"6A96337E70104406",
	"1FE66D4D2385A359",
	"7CAF713E1E322869",
	"E56B78FA4A99A3EB",
	"73A31C8787AD12EC",
	"6263664F9A9800C6",
	"C4D24BF9DF7F37FA",
	"12A5B04D7FF7D34F",
	"E422598A5AE1DCF6"
};
/*************************************************************************************
作    者: 王佳斌
版    权: 艾体威尔电子技术(北京)有限公司
函数功能: 写主密钥API返回值处理
输入参数: Title:测试项目标题 mkindex:存储主密钥的索引
		  Mode:0x01-Key为单DES密钥(8字节) 0x03-Key为3DES密钥(16字节)
		  data:密钥值
输出参数: 无
返 回 值: 0:成功    其它 :失败  
备	  注: 无
*************************************************************************************/
unsigned char PEDWriteMKey_Api_Ret(char *Title, unsigned char Mkindex, unsigned char Mode , unsigned char *Data)
{
	unsigned char Ret = 0;
	char Tempbuf[128];
	
	ScrClrLine_Api(LINE3 , LINE4);	
	ScrDisp_Api(LINE3, 0, Title, FDISP|CDISP);
	Ret = PEDWriteMKey_Api(Mkindex , Mode , Data);
	memset(Tempbuf, 0, sizeof(Tempbuf));
	sprintf(Tempbuf , "index :%d\t ret：%d\t" ,Mkindex, Ret);	
	ScrDisp_Api(LINE3 , 0 , Tempbuf , FDISP|CDISP);	
        
	Lib_LcdPrintxy(0, 2*8, 0x02, "%s",Tempbuf);
        //Lib_KbGetCh();
        
	if (Ret == 0)
	{
		ScrDisp_Api(LINE4 , 0 , "master write ok" , FDISP|CDISP);
//		strcat(Tempbuf, "  主密钥写入成功\n");
//		strcat(Tempbuf, "\n");
		return 0;
	}
	else if (Ret == 1)
	{
		ScrDisp_Api(LINE4 , 0 , "master timeout" , FDISP|CDISP);
		strcat(Tempbuf, "  master timeout\n"); 
	}
	else if (Ret == 2)
	{
		ScrDisp_Api(LINE4 , 0 , "master index err" , FDISP|CDISP);
		strcat(Tempbuf, "master index err\n");
	}
	else if (Ret == 3)
	{
		ScrDisp_Api(LINE4 , 0 , "master Mode err" , FDISP|CDISP);
		strcat(Tempbuf, "master Mode err\n");
	}
	else
	{	
          
		ScrDisp_Api(LINE4 , 0 , "master write err" , FDISP|CDISP);
		strcat(Tempbuf, "master write err\n");
	}
	WriteFile_Api(TEST_PED_LOG, (u8*)Title, GetFileSize_Api(TEST_PED_LOG), strlen(Title));
	WriteFile_Api(TEST_PED_LOG, (unsigned char *)Tempbuf, GetFileSize_Api(TEST_PED_LOG), strlen(Tempbuf));
	return Ret;
}
/*************************************************************************************
作    者: 王佳斌
版    权: 艾体威尔电子技术(北京)有限公司
函数功能: 写工作密钥API返回值处理
输入参数: Title:测试项目标题 MkeyIndex:存储主密钥的索引  WkeyIndex:存储工作密钥的索引
		  Mode:0x01-DES加密 0x03-3DES加密 0x81-DES解密  0x83-3DES解密 
               0x13-3DES解密,并将加解密的结果存放在单DES区(主要用于银联的密钥的解析)
		  Data:密钥值
输出参数: 无
返 回 值: 0:成功 其它:失败  
备	  注: 无
*************************************************************************************/
unsigned char PEDWriteWKey_Api_Ret(char *Title, unsigned char MkeyIndex , unsigned char WkeyIndex , unsigned char Mode , unsigned char *Data)
{
	unsigned char Ret = 0;
	char Tempbuf[128];

	ScrClrLine_Api(LINE3, LINE5);
	memset(Tempbuf, 0, sizeof(Tempbuf));
	ScrDisp_Api(LINE3 , 0 , Title , FDISP|CDISP);
	Ret = PEDWriteWKey_Api(MkeyIndex , WkeyIndex , Mode , Data);
	sprintf(Tempbuf , "index:%d\tret:%d\t" , WkeyIndex, Ret);	
        
	Lib_LcdPrintxy(0, 2*8, 0x02, "%s",Tempbuf);
        //Lib_KbGetCh();
        
	if (Ret == 0)
	{
		ScrDisp_Api(LINE4 , 0 , "工作密钥写入成功" , FDISP|CDISP);
//		strcat(Tempbuf, "工作密钥写入成功\n");
//		strcat(Tempbuf, "\n");
		return 0;
	}
	else if (Ret == 1)
	{
		ScrDisp_Api(LINE4 , 0 , "工作密钥写入超时" , FDISP|CDISP);
		strcat(Tempbuf, "工作密钥写入超时\n");
	}
	else if (Ret == 2)
	{
		ScrDisp_Api(LINE4 , 0 , "工作密钥索引非法" , FDISP|CDISP);
		strcat(Tempbuf, "工作密钥索引非法\n");
	}
	else if (Ret == 3)
	{
		ScrDisp_Api(LINE4 , 0 , "工作密钥Mode非法" , FDISP|CDISP);
		strcat(Tempbuf, "工作密钥Mode非法\n");
	}
	else if (Ret == -1)
	{
		ScrDisp_Api(LINE4 , 0 , "工作密钥写入失败" , FDISP|CDISP);
		strcat(Tempbuf, "工作密钥写入失败\n");
	}
	else
	{
		strcat(Tempbuf , "API没有给的其他返回值\n");
		ScrDisp_Api(LINE3 , 0 , "API没有给的其他返回值" , FDISP|CDISP);
	}
	WriteFile_Api(TEST_PED_LOG, (u8*)Title, GetFileSize_Api(TEST_PED_LOG), strlen(Title));
	WriteFile_Api(TEST_PED_LOG , (unsigned char *)Tempbuf , GetFileSize_Api(TEST_PED_LOG) , strlen(Tempbuf));
	return Ret;
}
/*************************************************************************************
作    者: 王佳斌
版    权: 艾体威尔电子技术(北京)有限公司
函数功能: MAC计算API返回值处理
输入参数: Title:测试项目标题 Wkindex:存储工作密钥的索引
		  Mode:MAC运算的算法 0x01-DES加密 0x03-3DES加密
		  Data:需进行MAC运算的数据包 Len:MAC运算的数据包的长度
		  Flag:0x00-ANSI X9.19(工行总行算法,当是工行算法时，Mode不起作用)
		       0x01-银联CBC算法  0x02-交通银行算法
输出参数: Out:输出结果
返 回 值: 0:成功 其它:失败  
备	  注: 无
*************************************************************************************/
unsigned char  PEDMac_Api_Ret(char *Title, unsigned char *KnownOut, unsigned char Wkindex,unsigned char Mode , unsigned char *Data,unsigned short Len , char *Out ,unsigned char Flag)
{
	unsigned char Ret =0, KnLen = 0;
	char Buf[48], Tempbuf[512];
	
	memset(Buf, 0, sizeof(Buf));
	memset(Tempbuf, 0, sizeof(Tempbuf));
	ScrClrLine_Api(LINE3,LINE4);
	if ((Mode & 0x03) == 0x03)
	{
		KnLen = 16;
	}
	else
	{
		KnLen = 8;
	}

	Ret = PEDMac_Api(Wkindex , Mode , Data , Len , (unsigned char*)Out , Flag);
	sprintf(Tempbuf , "索引:%d\t返回值:%d\t" , Wkindex, Ret);
	ScrDisp_Api(LINE3, 0, Tempbuf, FDISP|CDISP);
	if (Ret == 0)
	{
		memset(Buf , 0 , sizeof(Buf));
		BcdToAsc_Api(Buf , (unsigned char *)Out ,  KnLen);
		if(memcmp(Buf, KnownOut, KnLen) == 0)
		{
			strcat(Buf , "\t计算正确");
			return Ret ;
		}
		ScrDisp_Api(LINE4 , 0 , Buf , FDISP|CDISP);
		strcat(Tempbuf , Buf);
		strcat(Tempbuf,"\tMAC计算错误\n");

	}
	else if (Ret == 1)
	{
		ScrDisp_Api(LINE4 , 0 , "失败" , FDISP|CDISP);
		strcat(Tempbuf , "失败\n");
	}
	else if (Ret == 2)
	{
		ScrDisp_Api(LINE4 , 0 , "带入Flag不对" , FDISP|CDISP);
		strcat(Tempbuf , "带入Flag不对\n");
	}
	else if (Ret == 3)
	{
		ScrDisp_Api(LINE4 , 0 , "带入Modem不对" , FDISP|CDISP);
		strcat(Tempbuf , "带入Modem不对\n");
	}
	else if (Ret == 4)
	{
		ScrDisp_Api(LINE4 , 0 , "带入索引非法" , FDISP|CDISP);
		strcat(Tempbuf , "带入索引非法\n");
	}
	else
	{
		strcat(Tempbuf , "API没有给的其他返回值\n");
		ScrDisp_Api(LINE3 , 0 , "API没有给的其他返回值" , FDISP|CDISP);
	}
	WriteFile_Api(TEST_PED_LOG , (unsigned char *)Title , GetFileSize_Api(TEST_PED_LOG), strlen(Title));	
	WriteFile_Api(TEST_PED_LOG , (unsigned char *)Tempbuf , GetFileSize_Api(TEST_PED_LOG), strlen(Tempbuf));
        return Ret;
}
/*************************************************************************************
作    者: 王佳斌
版    权: 艾体威尔电子技术(北京)有限公司
函数功能: 写入主密钥工作密钥，然后用银联算法计算mac结果
入口参数: 无
输出参数: 无
返 回 值: 无
备	  注: 无
*************************************************************************************/
void PEDWriteMkey_Wkey(void)
{
	unsigned char KeyId = 0, Date[1024],bRet;
	char MacOut[32], AscBuf[1024];

	strcpy(AscBuf, "600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e");
	AscToBcd_Api(Date, AscBuf, strlen(AscBuf));

	ScrCls_Api();
	//=======================================================
	//单3DES工作密钥主密钥
	//=======================================================
	//WriteFile_Api(TEST_PED_LOG , (unsigned char *)"===>写入3DES主密钥工作密钥\n" , GetFileSize_Api(TEST_PED_LOG), 27);
	for (KeyId = 0 ; KeyId < PEDID ; KeyId++)
	{
		memset(MacOut, 0, sizeof(MacOut));
		bRet = PEDWriteMKey_Api_Ret("for lose to write AKEY key\t", KeyId, 0x03,  Mkey_3Des[KeyId]);
                if(bRet)
                {
                   Lib_KbGetCh();

                }
		bRet = PEDWriteWKey_Api_Ret("for lose to write work key\t",KeyId, KeyId, 0x13, Wkey_3Des[KeyId]);
                
		ScrDisp_Api(LINE5 , 0 , (char*)CupMacOut[KeyId], NOFDISP|CDISP);
                
	        Lib_LcdPrintxy(0, 0, 0x00, "%s",(char*)CupMacOut[KeyId]);
                if(bRet)
                  Lib_KbGetCh();
        
		bRet = PEDMac_Api_Ret("calc MAC\t", CupMacOut[KeyId], KeyId , 0x03 , Date , (unsigned short)(strlen(AscBuf)/2) , MacOut , 0x01);
		ScrDisp_Api(LINE5 , 0 , MacOut, NOFDISP|CDISP);
                
	        Lib_LcdPrintxy(0, 0, 0x00, "%s",(char*)MacOut);
                if(bRet)
                  Lib_KbGetCh();
                
	}
// 	//=======================================================
// 	//单DES工作密钥主密钥
// 	//=======================================================
// 	WriteFile_Api(TEST_PED_LOG , (unsigned char *)"===>写入DES主密钥工作密钥\n" , GetFileSize_Api(TEST_PED_LOG), 26);
// 	for (KeyId = 0 ; KeyId <= PEDID ; KeyId++)
// 	{
// 		memset(MacOut, 0, sizeof(MacOut));
// 		PEDWriteMKey_Api_Ret("为验证是否丢密钥而写AKEY密钥\t", KeyId, 0x01,  Mkey_Des[KeyId]);
// 		PEDWriteWKey_Api_Ret("为验证是否丢密钥而写工作密钥\t",KeyId, KeyId, 0x13, Wkey_Des[KeyId]);
// 		ScrDisp_Api(LINE5 , 0 , (char*)CupMacOut[KeyId] , NOFDISP|CDISP);
// 		PEDMac_Api_Ret("计算MAC\t", CupMacOut[KeyId], KeyId , 0x01 , Date , (unsigned short)(strlen(AscBuf)/2) , MacOut , 0x01);
// 		ScrDisp_Api(LINE5 , 0 , MacOut, NOFDISP|CDISP);
// 	}
// 	
	return ;
}
/*************************************************************************************
作    者: 王佳斌
版    权: 艾体威尔电子技术(北京)有限公司
函数功能: 用银联算法计算mac结果验证主密钥工作密钥是否丢失
入口参数: 无
输出参数: 无
返 回 值: 无
备	  注: 无
*************************************************************************************/
void PEDIsLoseMkey_Wkey(void)
{
	unsigned char KeyId = 0, Date[1024];
	char MacOut[32], AscBuf[1024];
	
	memset(AscBuf, 0, sizeof(AscBuf));
	strcpy(AscBuf , "600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e30353030303030303000600005000008802300001020c0005190000010312154513110000830313031303130303032303030313137303030313030383032303030313137303030310014462d504f534320332e372e302e");					
	memset(Date, 0, sizeof(Date));
	AscToBcd_Api(Date, AscBuf, strlen(AscBuf));
	ScrCls_Api();
	
	WriteFile_Api(TEST_PED_LOG , (unsigned char *)"===>主密钥工作密钥是否丢失\n" , GetFileSize_Api(TEST_PED_LOG), 27);
	for (KeyId = 0 ; KeyId <= PEDID ; KeyId++)
	{
		memset(MacOut, 0, sizeof(MacOut));
		PEDMac_Api_Ret("验证主密钥工作密钥是否丢失\t", CupMacOut[KeyId], KeyId , 0x03 , Date , (unsigned short)(strlen(AscBuf)/2) , MacOut , 0x01);
		ScrDisp_Api(LINE5 , 0 , MacOut, NOFDISP|CDISP);
	}

}